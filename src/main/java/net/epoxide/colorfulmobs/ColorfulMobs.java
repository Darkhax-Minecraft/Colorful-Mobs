package net.epoxide.colorfulmobs;

import cpw.mods.fml.common.FMLCommonHandler;
import cpw.mods.fml.common.Mod;
import cpw.mods.fml.common.Mod.EventHandler;
import cpw.mods.fml.common.ModMetadata;
import cpw.mods.fml.common.SidedProxy;
import cpw.mods.fml.common.event.FMLInitializationEvent;
import cpw.mods.fml.common.event.FMLPreInitializationEvent;
import cpw.mods.fml.common.network.NetworkRegistry;
import cpw.mods.fml.common.network.simpleimpl.SimpleNetworkWrapper;
import cpw.mods.fml.relauncher.Side;
import net.darkhax.bookshelf.lib.util.Utilities;
import net.epoxide.colorfulmobs.addons.AddonManager;
import net.epoxide.colorfulmobs.common.CommonProxy;
import net.epoxide.colorfulmobs.common.network.PacketColorSync;
import net.epoxide.colorfulmobs.common.network.PacketColorUpdate;
import net.epoxide.colorfulmobs.handler.ConfigurationHandler;
import net.epoxide.colorfulmobs.handler.ContentHandler;
import net.epoxide.colorfulmobs.handler.CreativeTabColor;
import net.epoxide.colorfulmobs.handler.ForgeEventHandler;
import net.epoxide.colorfulmobs.handler.GuiHandler;
import net.epoxide.colorfulmobs.lib.Constants;
import net.minecraft.creativetab.CreativeTabs;
import net.minecraftforge.common.MinecraftForge;

import java.util.Arrays;

@Mod(modid = Constants.MOD_ID, name = Constants.MOD_NAME, version = Constants.VERSION_NUMBER, guiFactory = Constants.FACTORY, dependencies = Constants.DEPENDANCIES)
public class ColorfulMobs {

    public static SimpleNetworkWrapper network;

    @SidedProxy(clientSide = Constants.CLIENT_PROXY_CLASS, serverSide = Constants.SERVER_PROXY_CLASS)
    public static CommonProxy proxy;

    @Mod.Instance(Constants.MOD_ID)
    public static ColorfulMobs instance;

    public static CreativeTabs tabColor = new CreativeTabColor();

    @EventHandler
    public void preInit (FMLPreInitializationEvent pre) {

        network = NetworkRegistry.INSTANCE.newSimpleChannel("ColorfulMobs");
        Utilities.registerMessage(network, PacketColorSync.class, 0, Side.CLIENT);
        Utilities.registerMessage(network, PacketColorUpdate.class, 1, Side.SERVER);

        setModInfo(pre.getModMetadata());
        proxy.registerSidedEvents();

        new ConfigurationHandler(pre.getSuggestedConfigurationFile());

        ContentHandler.initItems();
        ContentHandler.initRecipe();
        ContentHandler.initLoot();
        ContentHandler.initAchievements();

        MinecraftForge.EVENT_BUS.register(new ForgeEventHandler());
        FMLCommonHandler.instance().bus().register(new ForgeEventHandler.FMLEventHandler());
        NetworkRegistry.INSTANCE.registerGuiHandler(this, new GuiHandler());

        AddonManager.preInit(pre);
    }

    @EventHandler
    public void init (FMLInitializationEvent init) {

        AddonManager.init(init);
    }

    /**
     * Sets the mod meta for a mod, this is the information displayed when looking at this
     * modification in the in-game mod list provided by MinecraftForge.
     *
     * @param meta : The ModMetadata object for this mod. This can be retrieved from the
     *             FMLPreInitializationEvent.
     */
    void setModInfo (ModMetadata meta) {

        meta.authorList = Arrays.asList("Darkhax", "lclc98");
        meta.logoFile = "/assets/colorfulmobs_logo.png";
        meta.credits = "Maintained by Darkhax";
        meta.description = "";
        meta.url = "http://darkhax.net";
        meta.autogenerated = false;
    }
}